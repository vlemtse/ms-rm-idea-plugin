plugins {
    id 'java'
    id 'org.jetbrains.intellij.platform' version '2.7.2'
}

group = 'com.example'
version = '1.0-SNAPSHOT'

repositories {
    mavenCentral()
    intellijPlatform {
        defaultRepositories()
    }
}

java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

dependencies {
    implementation 'org.yaml:snakeyaml:2.2'
    testImplementation 'junit:junit:4.13.2'
    
    intellijPlatform {
        intellijIdeaCommunity('2024.2')
        bundledPlugin('com.intellij.java')
        instrumentationTools()
    }
}

// See https://plugins.jetbrains.com/docs/intellij/tools-intellij-platform-gradle-plugin.html
intellijPlatform {
    pluginConfiguration {
        name = 'RoleModelPreview'
        version = '1.0.0'
    }
    
    instrumentCode = true
}

signPlugin {
    certificateChain = System.getenv("CERTIFICATE_CHAIN")
    privateKey = System.getenv("PRIVATE_KEY")
    password = System.getenv("PRIVATE_KEY_PASSWORD")
}

publishPlugin {
    token = System.getenv("PUBLISH_TOKEN")
}